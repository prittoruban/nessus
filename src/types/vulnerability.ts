// ===============================================
// COMPREHENSIVE TYPE DEFINITIONS FOR EXECUTIVE REPORT
// ===============================================

export interface Vulnerability {
  id: string;
  cve: string | null;
  severity: 'critical' | 'high' | 'medium' | 'low' | 'info';
  plugin_name: string;
  plugin_id?: string;
  vuln_name: string;
  description: string | null;
  solution: string | null;
  synopsis: string | null;
  ip_address: string;
  port: number | null;
  protocol?: string;
  service_name?: string;
  cvss_score: number | null;
  risk_priority?: string;
  is_zero_day: boolean;
  exploitability?: string;
  report_id: string;
  host_id?: string;
  iteration: number;
  first_detected: string;
  last_seen: string;
  created_at: string;
  updated_at: string;
}

export interface Report {
  id: string;
  // Organization & Report Details
  org_name: string;
  source_type: 'internal' | 'external';
  iteration: number;
  
  // Report Metadata
  name: string;
  description?: string;
  document_type: string;
  version: string;
  
  // Personnel
  assessee?: string;
  assessor?: string;
  reviewer?: string;
  approver?: string;
  conducted_by?: string;
  created_by?: string;
  
  // Scan Details
  scan_start_date?: string;
  scan_end_date?: string;
  test_location: string;
  tool_used: string;
  scan_description: string;
  
  // File Upload Details
  file_name: string;
  file_size: number;
  
  // Calculated Aggregations
  number_of_ips: number;
  total_vulnerabilities: number;
  critical_count: number;
  high_count: number;
  medium_count: number;
  low_count: number;
  info_count: number;
  zero_day_count: number;
  
  // Report Content
  methodology?: string;
  project_scope_notes?: string;
  conclusion?: string;
  
  // Executive Report Specific
  confidentiality_level: string;
  legal_disclaimer: string;
  pdf_generated_at?: string;
  pdf_file_path?: string;
  
  // Status & Timestamps
  status: 'processing' | 'completed' | 'failed';
  upload_date: string;
  processed_date?: string;
  created_at: string;
  updated_at: string;
}

export interface ReportHost {
  id: string;
  report_id: string;
  ip_address: string;
  hostname?: string;
  status: 'Completed' | 'Failed' | 'Partial';
  iteration: number;
  critical_count: number;
  high_count: number;
  medium_count: number;
  low_count: number;
  info_count: number;
  total_count: number;
  zero_day_count: number;
  created_at: string;
  updated_at: string;
}

export interface VulnerabilityStats {
  total: number;
  critical: number;
  high: number;
  medium: number;
  low: number;
  info: number;
}

export interface VulnerabilityQuery {
  page: number;
  limit: number;
  severity: string;
  report_id?: string;
  search?: string;
  sort?: string;
  order?: 'asc' | 'desc';
}

export interface IPSummary {
  ip: string;
  hostname?: string;
  total: number;
  critical: number;
  high: number;
  medium: number;
  low: number;
  info: number;
}

export interface HostVulnerabilitySummary {
  ip_address: string;
  hostname?: string;
  critical: number;
  high: number;
  medium: number;
  low: number;
  total: number;
}

export interface RiskModel {
  priority: string;
  severity: string;
  cvss_range: string;
  description: string;
}

export interface ZeroDayVulnerability extends Vulnerability {
  is_zero_day: true;
}

export interface VulnerabilityWithRemediation extends Vulnerability {
  recommended_fix: string;
}

export interface ExecutiveReportData {
  report: Report;
  hosts: ReportHost[];
  vulnerabilities: Vulnerability[];
  hostSummaries: HostVulnerabilitySummary[];
  vulnerabilityStats: VulnerabilityStats;
  zeroDayVulnerabilities: ZeroDayVulnerability[];
  allVulnerabilitiesWithRemediation: VulnerabilityWithRemediation[];
}

export interface PDFGenerationOptions {
  includeCharts?: boolean;
  confidential?: boolean;
  watermark?: string;
  passwordProtect?: boolean;
}

export type SeverityLevel = 'critical' | 'high' | 'medium' | 'low' | 'info';

export type RiskPriority = 'P1' | 'P2' | 'P3' | 'P4' | 'P5';

// Static Risk Model Data
export const RISK_MODEL_DATA: RiskModel[] = [
  {
    priority: 'P1',
    severity: 'Critical',
    cvss_range: '9.0–10.0',
    description: 'Full system compromise, data exfiltration possible'
  },
  {
    priority: 'P2',
    severity: 'High',
    cvss_range: '7.0–8.9',
    description: 'Major security flaws risking unauthorized access'
  },
  {
    priority: 'P3',
    severity: 'Medium',
    cvss_range: '4.0–6.9',
    description: 'Security flaws that need chaining to become exploitable'
  },
  {
    priority: 'P4',
    severity: 'Low',
    cvss_range: '0.1–3.9',
    description: 'Minor misconfigurations or indirect security threats'
  },
  {
    priority: 'P5',
    severity: 'Informational',
    cvss_range: '0.0',
    description: 'Informational findings with no direct security impact'
  }
];

// Static Content
export const EXECUTIVE_SUMMARY_CONTENT = {
  objective: `This internal vulnerability assessment was conducted to understand the security posture and identify potential vulnerabilities affecting the organization's IT infrastructure. The assessment provides a comprehensive analysis of security weaknesses that could be exploited by malicious actors, along with detailed remediation recommendations to strengthen the overall security framework.`,
  
  disclaimer: `This assessment did not include brute-force attacks, denial-of-service testing, phishing simulations, or physical security evaluations. The scope was limited to network-based vulnerability identification and analysis.`
};

export const METHODOLOGY_STEPS = [
  {
    step: 1,
    title: 'Asset Selection',
    description: 'Identification and cataloging of all network assets within the defined scope of assessment.'
  },
  {
    step: 2,
    title: 'Reachability Checks',
    description: 'Verification of network connectivity and accessibility to target systems and services.'
  },
  {
    step: 3,
    title: 'Informed Initiation',
    description: 'Coordination with stakeholders and establishment of assessment parameters and boundaries.'
  },
  {
    step: 4,
    title: 'Tool Execution',
    description: 'Deployment of automated vulnerability scanning tools and manual verification techniques.'
  },
  {
    step: 5,
    title: 'Consolidation & Validation',
    description: 'Analysis and verification of findings to eliminate false positives and ensure accuracy.'
  },
  {
    step: 6,
    title: 'Severity Reclassification',
    description: 'Risk assessment and prioritization based on organizational context and business impact.'
  },
  {
    step: 7,
    title: 'Reporting',
    description: 'Compilation of findings into structured reports with actionable remediation guidance.'
  },
  {
    step: 8,
    title: 'Secure Sharing',
    description: 'Confidential delivery of assessment results to authorized stakeholders.'
  }
];

export const CONCLUSION_CONTENT = {
  summary: `The vulnerability assessment has identified various security findings across the tested infrastructure. It is strongly recommended to prioritize the remediation of critical and high-severity vulnerabilities to significantly reduce the organization's attack surface.`,
  
  recommendations: [
    'Implement a systematic patch management process to address identified vulnerabilities',
    'Conduct follow-up scans after remediation efforts to verify successful mitigation',
    'Establish regular vulnerability assessments to maintain awareness of evolving threats',
    'Develop incident response procedures to handle potential security breaches',
    'Provide security awareness training to staff to reduce human-factor risks'
  ],
  
  future: `The cybersecurity threat landscape continues to evolve rapidly. Regular assessments and proactive security measures are essential to maintain a robust defensive posture against emerging threats and attack vectors.`
};
